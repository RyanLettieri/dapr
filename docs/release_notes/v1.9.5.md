# Dapr 1.9.5

- Fixes a panic in the Azure Cosmos DB state store component when performing transaction request with ETags
- Fixes component initialization failure when the built-in Kubernetes secret store is disabled
- Fixes nil dereference crash in placement membership heartbeat loop in sidecar

## Fixes a panic in the Azure Cosmos DB state store component when performing transaction request with ETags

### Problem

When setting any ETag in a transaction request with the Azure Cosmos DB state store, Dapr panics with a nil pointer dereference.

### Impact

This issue impacts all users of the Azure Cosmos DB state store on Dapr 1.9.0-1.9.4.

### Root cause

When setting an ETag on a transaction request in the Azure Cosmos DB state store, a bug causes Dapr to panic.

### Solution

We fixed a bug that caused Dapr to panic.


## Fixes component initialization failure when the built-in Kubernetes secret store is disabled
 
### Problem

When running on Kubernetes, Dapr automatically initializes a Kubernetes secret store in each sidecar. Starting with Dapr 1.8, this behavior can be [turned off](https://docs.dapr.io/reference/arguments-annotations-overview/) using the `dapr.io/disable-builtin-k8s-secret-store`.

However, with the built-in Kubernetes secret store disabled, an error prevented components from being able to retrieve secrets [stored as Kubernetes secrets](https://docs.dapr.io/operations/components/component-secrets/#referencing-a-kubernetes-secret) during initialization. This caused components to fail to initialize due to not being able to read secrets, for example connection strings or passwords.
 
### Impact

The issue impacts users on Dapr 1.8.0-1.9.4 who want to disable the built-in Kubernetes secret store.
 
### Root cause

In Dapr, components that use secrets stored as Kubernetes secrets should not need the built-in Kubernetes secret store to be loaded to work. This is because the Dapr Operator service populates the secrets from the Kubernetes secret store and passes them to the sidecar automatically.

However, during initialization of a component that references a secret stored in Kubernetes, a bug caused Dapr to return an error if the built-in Kubernetes secret store was disabled, and the value of the secret as included by the Dapr Operator was ignored.

### Solution
 
We have implemented a fix in the component initialization sequence. Now, components that reference secrets from the Kubernetes secret store do not need the built-in Kubernetes secret store to be enabled anymore.


## Fixes nil dereference crash in placement membership heartbeat loop in sidecar

### Problem

Dapr sidecar panics due to a nil dereference in the actor placement service.

### Impact

This issue impacts all users who are using actors.

### Root cause

After closing the client stream in the actor placement service, the stream was being set to nil.

### Solution

We updated actor placement service to properly close the client stream and no longer set it to nil.
